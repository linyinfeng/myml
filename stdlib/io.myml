import "fix.myml" ;;
import "list.myml" ;;
import "char.myml" ;;

ioPutChar = ioPutChar# ;;
ioGetChar = ioGetChar# ;;

ioPutString s = listMap ioPutChar s; unit ;;

ioPutStringLine s = ioPutString s; ioPutChar '\n' ;;

rec ioGetLine _ =
  let c = ioGetChar unit in
    if charEq c '\n'
    then listNil
    else listCons c (ioGetLine unit) ;;
