import "fix.myml" ;;
import "list.myml" ;;
import "char.myml" ;;

ioPutChar = putChar# ;;
ioGetChar = getChar# ;;

ioPutString s = listMap ioPutChar s; unit ;;

ioPutStringLine s = ioPutString s; ioPutChar '\n' ;;

ioGetLine = fix (Î» getLine _ .
  let c = ioGetChar unit in
    if charEq c '\n'
    then listNil
    else listCons c (getLine unit)) ;;
