import "fix.myml" ;;
import "list.myml" ;;
import "char.myml" ;;

ioPutChar = putChar# ;;
ioGetChar = getChar# ;;

ioPutString s = listMap ioPutChar s; unit ;;

ioPutStringLine s = ioPutString s; ioPutChar '\n' ;;

ioGetLine =
  let getLine' gl _ =
    let c = ioGetChar unit in
      if charEq c '\n'
      then listNil
      else listCons c (gl unit)
  in fix getLine' ;;
