import "fix.myml" ;;

listNil = `nil unit ;;

listCons x xs = `cons { head = x, tail = xs } ;;

listSingleton x = listCons x listNil ;;

listLength = fix (λ len .
  [ `nil _ = 0
  , `cons l = succ (len l.tail) ]) ;;

list++ = fix (λ ++ .
  [ `nil _ = \ ys . ys
  , `cons l = \ ys . listCons l.head (++ l.tail ys) ] ;;

listMap f = fix (λ map .
  [ `nil _ = listNil
  , `cons l = listCons (f l.head) (map l.tail) ] ;;
