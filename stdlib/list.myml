import "fix.myml" ;;

listNil = `nil unit ;;

listCons x xs = `cons { head = x, tail = xs } ;;

listSingleton x = listCons x listNil ;;

listLength =
  let gen len =
    [ `nil _ = 0
    , `cons l = succ (len l.tail) ]
  in
    fix gen ;;

list++ =
  let gen ++ =
    [ `nil _ = \ ys . ys
    , `cons l = \ ys . listCons l.head (++ l.tail ys) ]
  in
    fix gen ;;

listMap f =
  let gen m =
    [ `nil _ = listNil
    , `cons l = listCons (f l.head) (m l.tail) ]
  in
    fix gen ;;
